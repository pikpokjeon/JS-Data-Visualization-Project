# 차트 리팩토링
```
    1. 차트 옵션에서 함수가 필요한 부분을 나눈다
    - 차트 생성에 필요한 요소들
    - 차트에 필요한 이벤트
    - x/y 축 좌표 계산하는 함수
    ```

    ```
    2. 차트 생성에 필요한 요소들을 분류한다
    https://developer.mozilla.org/ko/docs/Web/SVG/Element

    (1) 한번만 렌더링 되는지/ 지속적으로 특정 조건하에 렌더링 되는지
    (2) 한 요소가 여러개 생성되어야 하는지

    - 컨테이너
    - 필터
    - 그래픽/ 모양 : 원, 사각형, 선, 패스, 텍스트
    - 그라디언트
    - 스크립트 필터 등등 ..
    ```

    ```
    3. 요소들을 생성하는 함수
    - 초기 속성이 적용된 요소 생성
    - 요소들에 속성을 동적으로 적용
    - 요소를 반복적으로 생성
    - 요소를 동적으로 생성( 업데이트)
    - 요소들을 결합하여, 형태를 구성하기 위한 함수 (그라데이션/ 배경자르기)
    ```

    ```
    4. 요소들로 트리를 구성하고 렌더링하는 함수
    - 요소들로 만들 수 있는 형태 트리 구조로 만들고
    - 사용자 입력값에 따른 전체 비율과 좌표값 연산
    - 필요한 부분에 해당 트리를 확장 가능하도록
    - 완성된 트리를 렌더링 (차트 init)
    ```


## Chart 프로젝트가 리팩토링이 필요한 이유
- 공유하는 동적 데이터의 흐름을 추적하기 힘들다
- 해당 데이터의 변화에 따른 메서드의 호출를 명확히 파악하기 힘들다
- SVG 요소를 여러번 수정해야하는 경우 하드코딩을 하고 있다

## 리팩토링 계획
- 공통적으로 접근해야하는 데이터를 관리하기 위해 PubSub 패턴을 사용하여 데이터를 생성하는 주체와 사용하는 주체를 분리하여 관리
- SVG 요소를 변화 해야하는 경우, 예정된 변화될 요소들을 그룹화하고 적용하는 함수 생성
- SVG 요소의 변화에 순서가 있다면 순서에 따른 동기식 적용 호출 함수 생성

## Pub/sub 서비스 ? 
- 메시지 전송자(Publisher)가 메시지 수신자(Subscriber)와 분리되는 메시징 서비스
```
상에서 하로 진행, 한가지 주제에 일대다 다대일 다대다 관계 성립가능.
1. Publisher (pub/sub 서비스 주제 생성) 데이터를 생성하고 구독권을 생성
3. Message (페이로드/컨텐츠설명하는 속성) 
4. MessageStorage filtered with topic/path (데이터 저장소)
5. Subscription (target to assign message, message- 토픽으로 구분)
6. Subscriber (target : 수신된 메세지에 확인 (Ack/Notify)을 통해 구독하는 데이터 수신 업데이트) 
```
#### SVG 라이브러리 구조
- Topic 메세지(상태)를 관리하는 스토어 (MessageStorage)
- svg 요소와 사용자 입력데이터에 대한 주제
- 새로운 메세지를 생성하는 메서드 (Publisher) 주체
- 발행된 메세지가 가공되 이동하는 파이프라인 ->  Subscriber로 이동
- Subscriber가 메세지를 수신하면, 승인 (update)를 진행
